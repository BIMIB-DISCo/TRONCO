<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Post-reconstruction • TRONCO</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Post-reconstruction">
<meta property="og:description" content="TRONCO">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TRONCO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.30.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/2_loading_data.html">Loading Data</a>
    </li>
    <li>
      <a href="../articles/3_data_visualization.html">Data visualization</a>
    </li>
    <li>
      <a href="../articles/4_data_manipulation.html">Data manipulation</a>
    </li>
    <li>
      <a href="../articles/5_model_inference.html">Model inference</a>
    </li>
    <li>
      <a href="../articles/6_post_reconstruction.html">Post-reconstruction</a>
    </li>
    <li>
      <a href="../articles/7_import_export.html">Import/export from other tools</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BIMIB-DISCo/TRONCO/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Post-reconstruction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BIMIB-DISCo/TRONCO/blob/HEAD/vignettes/6_post_reconstruction.Rmd" class="external-link"><code>vignettes/6_post_reconstruction.Rmd</code></a></small>
      <div class="hidden name"><code>6_post_reconstruction.Rmd</code></div>

    </div>

    
    
<p>TRONCO provides functions to plot a model, access information about
the probabilities used to extract it from data, and two types of
confidence measures: those used to infer the model, and those computed a
posteriori from it.</p>
<p>Function <code>view</code> provides updated information about a model
if this is available.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/view.html">view</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Description: CAPRI - aCML.</span></span>
<span><span class="co">## -- TRONCO Dataset: n=64, m=26, |G|=10, patterns=9.</span></span>
<span><span class="co">## Events (types): Ins/Del, Missense point, Nonsense point, Pattern.</span></span>
<span><span class="co">## Colors (plot): #7FC97F, #4483B0, #fab3d8, slateblue.</span></span>
<span><span class="co">## Events (5 shown):</span></span>
<span><span class="co">##   gene 4 : Ins/Del TET2</span></span>
<span><span class="co">##   gene 5 : Ins/Del EZH2</span></span>
<span><span class="co">##   gene 6 : Ins/Del CBL</span></span>
<span><span class="co">##   gene 7 : Ins/Del ASXL1</span></span>
<span><span class="co">##   gene 29 : Missense point SETBP1</span></span>
<span><span class="co">## Genotypes (5 shown):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## -- TRONCO Model(s):  CAPRI </span></span>
<span><span class="co">## Score optimization via Hill-Climbing.</span></span>
<span><span class="co">## BIC, AIC regularizers.</span></span>
<span><span class="co">## BIC: score -566.1804 | logLik -499.6382 | 6 selective advantage relations.</span></span>
<span><span class="co">## AIC: score -528.7683 | logLik -492.7683 | 10 selective advantage relations.</span></span>
<span><span class="co">## Available confidence measures:</span></span>
<span><span class="co">##  Temporal priority | Probability raising | Hypergeometric</span></span></code></pre>
<div class="section level2">
<h2 id="visualizing-a-reconstructed-model">Visualizing a reconstructed model<a class="anchor" aria-label="anchor" href="#visualizing-a-reconstructed-model"></a>
</h2>
<p>We can plot a model by using function . Here, we plot the aCML model
inferred by CAPRI with BIC and AIC as a regolarizator. We set some
parameters to get a nice plot (scaling etc.), and distinguish the edges
detected by the two regularization techniques. The confidence of each
edge is shown in terms of temporal priority and probability raising
(selective advantage scores) and hypergeometric testing (statistical
relevance of the dataset of input). Events are annotated as in the
oncoprint, edge p-values above a minium threshold (default 0.05) are
red.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.capri</span>, </span>
<span>    fontsize <span class="op">=</span> <span class="fl">12</span>, </span>
<span>    scale.nodes <span class="op">=</span> <span class="fl">0.6</span>, </span>
<span>    confidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tp'</span>, <span class="st">'pr'</span>, <span class="st">'hg'</span><span class="op">)</span>, </span>
<span>    height.logic <span class="op">=</span> <span class="fl">0.25</span>, </span>
<span>    legend.cex <span class="op">=</span> <span class="fl">0.35</span>, </span>
<span>    pathways <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors <span class="op">=</span> <span class="va">gene.hypotheses</span><span class="op">)</span>, </span>
<span>    label.edge.size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Annotating nodes with pathway information. </span></span>
<span><span class="co">## Annotating pathways with RColorBrewer color palette Set1 .</span></span>
<span><span class="co">## Adding confidence information: tp, pr, hg </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<p><img src="6_post_reconstruction_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
<p>We can also make a multiplot with this function, which in this case
we do by showing the models inferred by the other algorithms based on
Minimum Spanning Trees.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.caprese</span>, fontsize <span class="op">=</span> <span class="fl">22</span>, scale.nodes <span class="op">=</span> <span class="fl">0.6</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Set automatic fontsize for edge labels:  11 </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.edmonds</span>, fontsize <span class="op">=</span> <span class="fl">22</span>, scale.nodes <span class="op">=</span> <span class="fl">0.6</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Set automatic fontsize for edge labels:  11 </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.chowliu</span>, fontsize <span class="op">=</span> <span class="fl">22</span>, scale.nodes <span class="op">=</span> <span class="fl">0.6</span>, legend.cex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Set automatic fontsize for edge labels:  11 </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.prim</span>, fontsize <span class="op">=</span> <span class="fl">22</span>, scale.nodes <span class="op">=</span> <span class="fl">0.6</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Set automatic fontsize for edge labels:  11 </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="figure">
<img src="6_post_reconstruction_files/figure-html/unnamed-chunk-4-1.png" alt="aCML data processed model by algorithms to extract models from individual patients, we show the otput of  CAPRESE,  and all algorithms based on Minimum Spanning Trees (Edmonds, Chow Liu and Prim). Only the  model retrieved by Chow Liu has two different edge colors as it was regularized with two different strategies: AIC and BIC." width="672"><p class="caption">
aCML data processed model by algorithms to extract models from
individual patients, we show the otput of CAPRESE, and all algorithms
based on Minimum Spanning Trees (Edmonds, Chow Liu and Prim). Only the
model retrieved by Chow Liu has two different edge colors as it was
regularized with two different strategies: AIC and BIC.
</p>
</div>
</div>
<div class="section level2">
<h2 id="accessing-information-within-a-model-e-g--confidence">Accessing information within a model (e.g., confidence)<a class="anchor" aria-label="anchor" href="#accessing-information-within-a-model-e-g--confidence"></a>
</h2>
<p>We can visualize a summary of the parameters used for the
reconstruction, test if an object has a model or delete it (which shall
be done to retrieve the original dataset).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.parameters.html">as.parameters</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   algorithm command regularization do.boot nboot pvalue min.boot min.stat</span></span>
<span><span class="co">## 1     CAPRI      hc            bic    TRUE     5   0.05        3     TRUE</span></span>
<span><span class="co">## 2     CAPRI      hc            aic    TRUE     5   0.05        3     TRUE</span></span>
<span><span class="co">##   boot.seed silent error.rates.epos error.rates.eneg restart</span></span>
<span><span class="co">## 1     12345  FALSE                0                0     100</span></span>
<span><span class="co">## 2     12345  FALSE                0                0     100</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/has.model.html">has.model</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/delete.model.html">delete.model</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="model-structure">Model structure<a class="anchor" aria-label="anchor" href="#model-structure"></a>
</h3>
<p>A set of functions can be used to visualize the content of object
which contains the reconstructed model. For instance, we can access the
adjacency matrix of a model by using <code>as.adj.matrix</code> which
will return a matrix for each one of the regularizators used – in this
case because CAPRI was run with both BIC/AIC.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.adj.matrix.html">as.adj.matrix</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ capri_bic: num [1:26, 1:26] 0 0 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##  $ capri_aic: num [1:26, 1:26] 0 0 0 0 0 0 0 0 1 0 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="empirical-probabilities">Empirical probabilities<a class="anchor" aria-label="anchor" href="#empirical-probabilities"></a>
</h3>
<p>Every model is inferred by estimating the empirical marginal, joint
and conditional probabilities for all the events, from input data. These
in some cases are estimated by a bootstrap procedure (see the algorithms
implemented). TRONCO has functions to extract such table, that could be
in turn printed by using external functions for, e.g., heatmap
visualization (see below for an example via the <code>pheatmap</code>
package). We show these functions working with the CAPRI model; in this
case the tables are the same for both BIC/AIC structures as they are
computed before performing penalized likelihood-fit. The marginal
<em>P(x)</em> for <em>x</em> an event in the dataset are obtained by
<code>as.marginal.probs</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">marginal.prob</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.marginal.probs.html">as.marginal.probs</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">marginal.prob</span><span class="op">$</span><span class="va">capri_bic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         marginal probability</span></span>
<span><span class="co">## gene 4           0.064630682</span></span>
<span><span class="co">## gene 5           0.009943182</span></span>
<span><span class="co">## gene 6           0.017045455</span></span>
<span><span class="co">## gene 7           0.126420455</span></span>
<span><span class="co">## gene 29          0.230113636</span></span>
<span><span class="co">## gene 30          0.078125000</span></span></code></pre>
<p>Similarly, the joint <em>P(x,y)</em> for every pair of events in the
dataset is given by <code>as.joint.probs</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joint.prob</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.joint.probs.html">as.joint.probs</a></span><span class="op">(</span><span class="va">model.capri</span>, models<span class="op">=</span><span class="st">'capri_bic'</span><span class="op">)</span></span>
<span><span class="va">joint.prob</span><span class="op">$</span><span class="va">capri_bic</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            gene 4      gene 5     gene 6</span></span>
<span><span class="co">## gene 4 0.06463068 0.000000000 0.00000000</span></span>
<span><span class="co">## gene 5 0.00000000 0.009943182 0.00000000</span></span>
<span><span class="co">## gene 6 0.00000000 0.000000000 0.01704545</span></span></code></pre>
<p>And <code>as.conditional.probs</code> finally gives the conditional
<em>P(x|y)</em> for every edge in the dataset.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conditional.prob</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.conditional.probs.html">as.conditional.probs</a></span><span class="op">(</span><span class="va">model.capri</span>, models<span class="op">=</span><span class="st">'capri_bic'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">conditional.prob</span><span class="op">$</span><span class="va">capri_bic</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         conditional probability</span></span>
<span><span class="co">## gene 4  0.2916667              </span></span>
<span><span class="co">## gene 5  0.1296296              </span></span>
<span><span class="co">## gene 6  0.2222222              </span></span>
<span><span class="co">## gene 7  1                      </span></span>
<span><span class="co">## gene 29 1                      </span></span>
<span><span class="co">## gene 30 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="confidence-measures">Confidence measures<a class="anchor" aria-label="anchor" href="#confidence-measures"></a>
</h3>
<p>Confidence scores can be accessed by function , which takes as
parameter the type of confidence measure that one wants to access to.
This will work for either confidence measures assessed before
reconstructing the model – if available –, or afterwards.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.confidence.html">as.confidence</a></span><span class="op">(</span><span class="va">model.capri</span>, conf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tp'</span>, <span class="st">'pr'</span>, <span class="st">'hg'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ hg: num [1:26, 1:26] 1 0.0625 0.0625 0.4219 0.6665 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##  $ tp: num [1:26, 1:26] 1.00 1.00 1.00 3.03e-06 6.32e-09 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##  $ pr: num [1:26, 1:26] 1 1 1 0.164 1 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:26] "gene 4" "gene 5" "gene 6" "gene 7" ...</span></span></code></pre>
<p>Other functions visualize tables summarizing the statistics for each
edge in the model, For instance, if one uses function
<code>as.selective.advantage.relations</code> the p-values for temporal
priority, probability raising and hypergeometric testing, as well as
other information about each edge can be accessed, e.g., the number of
observations for the upstream and the downstream events.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.selective.advantage.relations.html">as.selective.advantage.relations</a></span><span class="op">(</span><span class="va">model.capri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $capri_bic</span></span>
<span><span class="co">##                 SELECTS             SELECTED OBS.SELECTS OBS.SELECTED</span></span>
<span><span class="co">## 1 Missense point SETBP1 Nonsense point ASXL1          14            5</span></span>
<span><span class="co">## 2   Missense point TET2         Ins/Del EZH2           5            1</span></span>
<span><span class="co">## 3   Missense point TET2          Ins/Del CBL           5            1</span></span>
<span><span class="co">## 4   Missense point EZH2         Ins/Del TET2           7            4</span></span>
<span><span class="co">## 5  Nonsense point ASXL1      Pattern XOR_CBL           5            4</span></span>
<span><span class="co">## 6     Pattern XOR_ASXL1   Missense point CBL          14            3</span></span>
<span><span class="co">##   TEMPORAL.PRIORITY PROBABILITY.RAISING HYPERGEOMETRIC</span></span>
<span><span class="co">## 1      1.265401e-08        6.653729e-09    0.002029387</span></span>
<span><span class="co">## 2      3.107997e-08        2.968162e-05    0.078125000</span></span>
<span><span class="co">## 3      7.055746e-07        1.172650e-05    0.000000000</span></span>
<span><span class="co">## 4      8.288203e-04        1.739852e-06    0.055944826</span></span>
<span><span class="co">## 5      1.253535e-02        1.262353e-05    0.040873436</span></span>
<span><span class="co">## 6      1.181758e-08        3.952172e-09    0.008736559</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $capri_aic</span></span>
<span><span class="co">##                  SELECTS              SELECTED OBS.SELECTS OBS.SELECTED</span></span>
<span><span class="co">## 1          Ins/Del ASXL1   Missense point KRAS           9            1</span></span>
<span><span class="co">## 2  Missense point SETBP1  Nonsense point ASXL1          14            5</span></span>
<span><span class="co">## 3    Missense point TET2          Ins/Del EZH2           5            1</span></span>
<span><span class="co">## 4    Missense point TET2           Ins/Del CBL           5            1</span></span>
<span><span class="co">## 5    Missense point EZH2          Ins/Del TET2           7            4</span></span>
<span><span class="co">## 6    Nonsense point TET2   Missense point NRAS           7            5</span></span>
<span><span class="co">## 7    Nonsense point TET2 Pattern NRAS_xor_KRAS           7            6</span></span>
<span><span class="co">## 8   Nonsense point ASXL1       Pattern XOR_CBL           5            4</span></span>
<span><span class="co">## 9  Pattern TET2_xor_IDH2         Ins/Del ASXL1          17            9</span></span>
<span><span class="co">## 10     Pattern XOR_ASXL1    Missense point CBL          14            3</span></span>
<span><span class="co">##    TEMPORAL.PRIORITY PROBABILITY.RAISING HYPERGEOMETRIC</span></span>
<span><span class="co">## 1       6.724574e-09        8.364015e-07    0.000000000</span></span>
<span><span class="co">## 2       1.265401e-08        6.653729e-09    0.002029387</span></span>
<span><span class="co">## 3       3.107997e-08        2.968162e-05    0.078125000</span></span>
<span><span class="co">## 4       7.055746e-07        1.172650e-05    0.000000000</span></span>
<span><span class="co">## 5       8.288203e-04        1.739852e-06    0.055944826</span></span>
<span><span class="co">## 6       5.292684e-04        1.416741e-07    0.011832364</span></span>
<span><span class="co">## 7       1.562932e-02        1.825523e-07    0.022184702</span></span>
<span><span class="co">## 8       1.253535e-02        1.262353e-05    0.040873436</span></span>
<span><span class="co">## 9       1.218091e-08        1.638856e-07    0.025903967</span></span>
<span><span class="co">## 10      1.181758e-08        3.952172e-09    0.008736559</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="confidence-via-non-parametric-and-statistical-bootstrap">Confidence via non-parametric and statistical bootstrap<a class="anchor" aria-label="anchor" href="#confidence-via-non-parametric-and-statistical-bootstrap"></a>
</h2>
<p>TRONCO provides three different strategies to perform bootstrap and
assess confidence of each edge in terms of a score in the range [0,
100], where 100 is the highest confidence). Non-parametric (default) and
statistical bootstrap strategies are available, and can be executed by
calling function <code>tronco.bootstrap</code> with <code>type</code>
parameter set appropriately. This function is parallel, and parameter
<code>cores.ratio</code> (default 1) can be used to percentage of
available cores that shall be used to compute the scores. Parameter
<code>nboot</code> controls the number of bootstrap iterations.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/tronco.bootstrap.html">tronco.bootstrap</a></span><span class="op">(</span><span class="va">model.capri</span>, nboot <span class="op">=</span> <span class="fl">3</span>, cores.ratio <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Executing now the bootstrap procedure, this may take a long time...</span></span>
<span><span class="co">##  Expected completion in approx. 00h:00m:03s </span></span>
<span><span class="co">##  Using 1 cores via "parallel" </span></span>
<span><span class="co">##  Reducing results</span></span>
<span><span class="co">## Performed non-parametric bootstrap with 3 resampling and 0.05 as pvalue for the statistical tests.</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/tronco.bootstrap.html">tronco.bootstrap</a></span><span class="op">(</span><span class="va">model.boot</span>, nboot <span class="op">=</span> <span class="fl">3</span>, cores.ratio <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="st">'statistical'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Executing now the bootstrap procedure, this may take a long time...</span></span>
<span><span class="co">##  Expected completion in approx. 00h:00m:03s </span></span>
<span><span class="co">##  Using 1 cores via "parallel" </span></span>
<span><span class="co">##  Reducing results</span></span>
<span><span class="co">## Performed statistical bootstrap with 3 resampling and 0.05 as pvalue for the statistical tests.</span></span></code></pre>
<p>Bootstrap scores can be annotated to the <code>tronco.plot</code>
output by setting them via the confidence parameter
<code>confidence=c('npb', 'sb')</code>. In this case edge thickness will
be proportional to the non-parametric <code>npb</code>) scores – the
last to appear in the <code>confidence</code> parameter.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.boot</span>, </span>
<span>    fontsize <span class="op">=</span> <span class="fl">12</span>, </span>
<span>    scale.nodes <span class="op">=</span> <span class="fl">.6</span>,   </span>
<span>    confidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sb'</span>, <span class="st">'npb'</span><span class="op">)</span>, </span>
<span>    height.logic <span class="op">=</span> <span class="fl">0.25</span>, </span>
<span>    legend.cex <span class="op">=</span> <span class="fl">.35</span>, </span>
<span>    pathways <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors<span class="op">=</span> <span class="va">gene.hypotheses</span><span class="op">)</span>, </span>
<span>    label.edge.size<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Annotating nodes with pathway information. </span></span>
<span><span class="co">## Annotating pathways with RColorBrewer color palette Set1 .</span></span>
<span><span class="co">## Adding confidence information: sb, npb </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="figure">
<img src="6_post_reconstruction_files/figure-html/unnamed-chunk-12-1.png" alt="aCML model reconstructed by CAPRI with AIC / BIC as regolarizators and annotated with both non-parametric and statistical bootstrap scores. Edge thickness is proportional to the non-parametric scores." width="384"><p class="caption">
aCML model reconstructed by CAPRI with AIC / BIC as regolarizators and
annotated with both non-parametric and statistical bootstrap scores.
Edge thickness is proportional to the non-parametric scores.
</p>
</div>
<p>Bootstrap scores can extracted or visualized even with other TRONCO
functions. For instance, we can accessall scores via
<code>as.bootstrap.scores</code>, which resembles function
<code>as.selective.advantage.relations</code> and will display the
scores per edge. Notice that even function <code>view</code> gives an
update output by mentioning the available bootstrap scores.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.bootstrap.scores.html">as.bootstrap.scores</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $capri_bic</span></span>
<span><span class="co">##                 SELECTS             SELECTED OBS.SELECTS OBS.SELECTED</span></span>
<span><span class="co">## 1 Missense point SETBP1 Nonsense point ASXL1          14            5</span></span>
<span><span class="co">## 2   Missense point TET2         Ins/Del EZH2           5            1</span></span>
<span><span class="co">## 3   Missense point TET2          Ins/Del CBL           5            1</span></span>
<span><span class="co">## 4   Missense point EZH2         Ins/Del TET2           7            4</span></span>
<span><span class="co">## 5  Nonsense point ASXL1      Pattern XOR_CBL           5            4</span></span>
<span><span class="co">## 6     Pattern XOR_ASXL1   Missense point CBL          14            3</span></span>
<span><span class="co">##   NONPAR.BOOT STAT.BOOT</span></span>
<span><span class="co">## 1   100.00000       100</span></span>
<span><span class="co">## 2    33.33333       100</span></span>
<span><span class="co">## 3    66.66667       100</span></span>
<span><span class="co">## 4     0.00000       100</span></span>
<span><span class="co">## 5    33.33333       100</span></span>
<span><span class="co">## 6     0.00000       100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $capri_aic</span></span>
<span><span class="co">##                  SELECTS              SELECTED OBS.SELECTS OBS.SELECTED</span></span>
<span><span class="co">## 1          Ins/Del ASXL1   Missense point KRAS           9            1</span></span>
<span><span class="co">## 2  Missense point SETBP1  Nonsense point ASXL1          14            5</span></span>
<span><span class="co">## 3    Missense point TET2          Ins/Del EZH2           5            1</span></span>
<span><span class="co">## 4    Missense point TET2           Ins/Del CBL           5            1</span></span>
<span><span class="co">## 5    Missense point EZH2          Ins/Del TET2           7            4</span></span>
<span><span class="co">## 6    Nonsense point TET2   Missense point NRAS           7            5</span></span>
<span><span class="co">## 7    Nonsense point TET2 Pattern NRAS_xor_KRAS           7            6</span></span>
<span><span class="co">## 8   Nonsense point ASXL1       Pattern XOR_CBL           5            4</span></span>
<span><span class="co">## 9  Pattern TET2_xor_IDH2         Ins/Del ASXL1          17            9</span></span>
<span><span class="co">## 10     Pattern XOR_ASXL1    Missense point CBL          14            3</span></span>
<span><span class="co">##    NONPAR.BOOT STAT.BOOT</span></span>
<span><span class="co">## 1      0.00000       100</span></span>
<span><span class="co">## 2    100.00000       100</span></span>
<span><span class="co">## 3      0.00000       100</span></span>
<span><span class="co">## 4    100.00000       100</span></span>
<span><span class="co">## 5      0.00000       100</span></span>
<span><span class="co">## 6     33.33333       100</span></span>
<span><span class="co">## 7     33.33333       100</span></span>
<span><span class="co">## 8     33.33333       100</span></span>
<span><span class="co">## 9     33.33333       100</span></span>
<span><span class="co">## 10    33.33333       100</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/view.html">view</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Description: CAPRI - aCML.</span></span>
<span><span class="co">## -- TRONCO Dataset: n=64, m=26, |G|=10, patterns=9.</span></span>
<span><span class="co">## Events (types): Ins/Del, Missense point, Nonsense point, Pattern.</span></span>
<span><span class="co">## Colors (plot): #7FC97F, #4483B0, #fab3d8, slateblue.</span></span>
<span><span class="co">## Events (5 shown):</span></span>
<span><span class="co">##   gene 4 : Ins/Del TET2</span></span>
<span><span class="co">##   gene 5 : Ins/Del EZH2</span></span>
<span><span class="co">##   gene 6 : Ins/Del CBL</span></span>
<span><span class="co">##   gene 7 : Ins/Del ASXL1</span></span>
<span><span class="co">##   gene 29 : Missense point SETBP1</span></span>
<span><span class="co">## Genotypes (5 shown):</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## -- TRONCO Model(s):  CAPRI </span></span>
<span><span class="co">## Score optimization via Hill-Climbing.</span></span>
<span><span class="co">## BIC, AIC regularizers.</span></span>
<span><span class="co">## BIC: score -566.1804 | logLik -499.6382 | 6 selective advantage relations.</span></span>
<span><span class="co">## AIC: score -528.7683 | logLik -492.7683 | 10 selective advantage relations.</span></span>
<span><span class="co">## Available confidence measures:</span></span>
<span><span class="co">##  Temporal priority | Probability raising | Hypergeometric</span></span>
<span><span class="co">## Bootstrap estimation available.</span></span></code></pre>
<p>If we want to access a matrix with the scores and visualize that in a
heatmap we can use for instance the <code>pheatmap</code> function of
TRONCO. In this case we need to use also function
<code>keysToNames</code> to translate internal TRONCO keys to mnemonic
names in the plot</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pheatmap.html">pheatmap</a></span><span class="op">(</span><span class="fu"><a href="../reference/keysToNames.html">keysToNames</a></span><span class="op">(</span><span class="va">model.boot</span>, <span class="fu"><a href="../reference/as.confidence.html">as.confidence</a></span><span class="op">(</span><span class="va">model.boot</span>, conf <span class="op">=</span> <span class="st">'sb'</span><span class="op">)</span><span class="op">$</span><span class="va">sb</span><span class="op">$</span><span class="va">capri_aic</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>           main <span class="op">=</span>  <span class="st">'Statistical bootstrap scores for AIC model'</span>,</span>
<span>           fontsize_row <span class="op">=</span> <span class="fl">6</span>,</span>
<span>           fontsize_col <span class="op">=</span> <span class="fl">6</span>,</span>
<span>           display_numbers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           number_format <span class="op">=</span> <span class="st">"%d"</span></span>
<span>           <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="6_post_reconstruction_files/figure-html/unnamed-chunk-14-1.png" alt="Heatmap of the bootstrap scores for the CAPRI aCML model (via AIC regularization)." width="672"><p class="caption">
Heatmap of the bootstrap scores for the CAPRI aCML model (via AIC
regularization).
</p>
</div>
</div>
<div class="section level2">
<h2 id="confidence-via-cross-validation-entropy-loss-prediction-and-posterior-classification-errors">Confidence via cross-validation (entropy loss, prediction and
posterior classification errors)<a class="anchor" aria-label="anchor" href="#confidence-via-cross-validation-entropy-loss-prediction-and-posterior-classification-errors"></a>
</h2>
<p>TRONCO implements <em>k</em>-fold cross-validation routines (from the
<em>bnlearn</em> package) to provide estimates of the following
statistics:</p>
<ul>
<li>the <em>negative entropy</em> (via <code>tronco.kfold.eloss</code>)
of a whole model ? i.e., the negated expected log-likelihood of the test
set for the Bayesian network fitted from the training set.</li>
<li>the <em>prediction error</em> (via
<code>tronco.kfold.prederr</code>) for a single node <em>x</em> and its
parents set <em>X</em> – i.e., how precisely we can predict the values
of <em>x</em> by using only the information present in its local
distribution, via <em>X</em>.</li>
<li>the <em>posterior classification error</em> (via
<code>tronco.kfold.posterr</code>) for a single node <em>x</em> and one
of its parent node <em>y in X</em> – i.e., the values of <em>x</em> are
predicted using only the information present in <em>y</em> by likelihood
weighting and Bayesian posterior estimates.</li>
</ul>
<p>By default, a 10 repetitions from 10-fold cross-validation experiment
are perfomed, for all the models which are found inside a TRONCO object
– in this case 2, one for CAPRI with BIC and one for CAPRI with AIC.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/tronco.kfold.eloss.html">tronco.kfold.eloss</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating entropy loss with k-fold cross-validation </span></span>
<span><span class="co">##  [ k = 10 | runs = 10 | regularizer = capri_bic ] ...  DONE</span></span>
<span><span class="co">##   Model logLik = -499.6382 </span></span>
<span><span class="co">##   Mean   eloss = 8.376919  |  1.676597 % </span></span>
<span><span class="co">##   Stdev  eloss =  0.1125324 </span></span>
<span><span class="co">## Calculating entropy loss with k-fold cross-validation </span></span>
<span><span class="co">##  [ k = 10 | runs = 10 | regularizer = capri_aic ] ...  DONE</span></span>
<span><span class="co">##   Model logLik = -492.7683 </span></span>
<span><span class="co">##   Mean   eloss = 8.367807  |  1.698122 % </span></span>
<span><span class="co">##   Stdev  eloss =  0.08515295</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/tronco.kfold.prederr.html">tronco.kfold.prederr</a></span><span class="op">(</span><span class="va">model.boot</span>, runs <span class="op">=</span> <span class="fl">2</span>, cores.ratio <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Using 1 cores via "parallel" </span></span>
<span><span class="co">##  Scanning 26 nodes for their prediction error (all parents). </span></span>
<span><span class="co">##  Regularizer:  capri_bic </span></span>
<span><span class="co">## *** Reducing results</span></span>
<span><span class="co">##  Scanning 26 nodes for their prediction error (all parents). </span></span>
<span><span class="co">##  Regularizer:  capri_aic </span></span>
<span><span class="co">## *** Reducing results</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/tronco.kfold.posterr.html">tronco.kfold.posterr</a></span><span class="op">(</span><span class="va">model.boot</span>, runs <span class="op">=</span> <span class="fl">2</span>, cores.ratio <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Using 1 cores via "parallel" </span></span>
<span><span class="co">##  Scanning 6 edges for posterior classification error. </span></span>
<span><span class="co">##  Regularizer: capri_bic </span></span>
<span><span class="co">## *** Reducing results</span></span>
<span><span class="co">##  Scanning 10 edges for posterior classification error. </span></span>
<span><span class="co">##  Regularizer: capri_aic </span></span>
<span><span class="co">## *** Reducing results</span></span></code></pre>
<p>These results can be visualized in terms of summary tables, as for
the other confidence scores.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.kfold.eloss.html">as.kfold.eloss</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               Mean %-of-logLik      Stdev</span></span>
<span><span class="co">## capri_bic 8.376919    1.676597 0.11253236</span></span>
<span><span class="co">## capri_aic 8.367807    1.698122 0.08515295</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.kfold.prederr.html">as.kfold.prederr</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $capri_bic</span></span>
<span><span class="co">##                   SELECTED MEAN.PREDERR SD.PREDERR</span></span>
<span><span class="co">## 5    Missense point SETBP1     0.218750          0</span></span>
<span><span class="co">## 6      Missense point NRAS     0.078125          0</span></span>
<span><span class="co">## 7      Missense point KRAS     0.015625          0</span></span>
<span><span class="co">## 8      Missense point TET2     0.078125          0</span></span>
<span><span class="co">## 9      Missense point EZH2     0.109375          0</span></span>
<span><span class="co">## 10      Missense point CBL     0.046875          0</span></span>
<span><span class="co">## 11     Missense point IDH2     0.046875          0</span></span>
<span><span class="co">## 12    Missense point SF3B1     0.015625          0</span></span>
<span><span class="co">## 13    Missense point CSF3R     0.078125          0</span></span>
<span><span class="co">## 14     Nonsense point TET2     0.109375          0</span></span>
<span><span class="co">## 15     Nonsense point EZH2     0.031250          0</span></span>
<span><span class="co">## 16    Nonsense point ASXL1     0.078125          0</span></span>
<span><span class="co">## 17    Nonsense point CSF3R     0.046875          0</span></span>
<span><span class="co">## 18   Pattern NRAS_xor_KRAS     0.093750          0</span></span>
<span><span class="co">## 19 Pattern SF3B1_xor_ASXL1     0.234375          0</span></span>
<span><span class="co">## 20   Pattern TET2_xor_IDH2     0.265625          0</span></span>
<span><span class="co">## 21    Pattern TET2_or_IDH2     0.281250          0</span></span>
<span><span class="co">## 22        Pattern XOR_TET2     0.250000          0</span></span>
<span><span class="co">## 23        Pattern XOR_EZH2     0.156250          0</span></span>
<span><span class="co">## 24         Pattern XOR_CBL     0.093750          0</span></span>
<span><span class="co">## 25       Pattern XOR_ASXL1     0.218750          0</span></span>
<span><span class="co">## 26        Pattern OR_CSF3R     0.109375          0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $capri_aic</span></span>
<span><span class="co">##                   SELECTED MEAN.PREDERR SD.PREDERR</span></span>
<span><span class="co">## 5    Missense point SETBP1    0.2187500 0.00000000</span></span>
<span><span class="co">## 6      Missense point NRAS    0.0781250 0.00000000</span></span>
<span><span class="co">## 7      Missense point KRAS    0.0156250 0.00000000</span></span>
<span><span class="co">## 8      Missense point TET2    0.0781250 0.00000000</span></span>
<span><span class="co">## 9      Missense point EZH2    0.1093750 0.00000000</span></span>
<span><span class="co">## 10      Missense point CBL    0.0468750 0.00000000</span></span>
<span><span class="co">## 11     Missense point IDH2    0.0468750 0.00000000</span></span>
<span><span class="co">## 12    Missense point SF3B1    0.0156250 0.00000000</span></span>
<span><span class="co">## 13    Missense point CSF3R    0.0781250 0.00000000</span></span>
<span><span class="co">## 14     Nonsense point TET2    0.1093750 0.00000000</span></span>
<span><span class="co">## 15     Nonsense point EZH2    0.0312500 0.00000000</span></span>
<span><span class="co">## 16    Nonsense point ASXL1    0.0781250 0.00000000</span></span>
<span><span class="co">## 17    Nonsense point CSF3R    0.0468750 0.00000000</span></span>
<span><span class="co">## 18   Pattern NRAS_xor_KRAS    0.0937500 0.00000000</span></span>
<span><span class="co">## 19 Pattern SF3B1_xor_ASXL1    0.2343750 0.00000000</span></span>
<span><span class="co">## 20   Pattern TET2_xor_IDH2    0.2656250 0.00000000</span></span>
<span><span class="co">## 21    Pattern TET2_or_IDH2    0.2812500 0.00000000</span></span>
<span><span class="co">## 22        Pattern XOR_TET2    0.2500000 0.00000000</span></span>
<span><span class="co">## 23        Pattern XOR_EZH2    0.1562500 0.00000000</span></span>
<span><span class="co">## 24         Pattern XOR_CBL    0.0859375 0.01104854</span></span>
<span><span class="co">## 25       Pattern XOR_ASXL1    0.2187500 0.00000000</span></span>
<span><span class="co">## 26        Pattern OR_CSF3R    0.1093750 0.00000000</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/as.kfold.posterr.html">as.kfold.posterr</a></span><span class="op">(</span><span class="va">model.boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $capri_bic</span></span>
<span><span class="co">##                 SELECTS             SELECTED MEAN.POSTERR SD.POSTERR</span></span>
<span><span class="co">## 1 Missense point SETBP1 Nonsense point ASXL1    0.0781250 0.00000000</span></span>
<span><span class="co">## 2   Missense point TET2         Ins/Del EZH2    0.0156250 0.00000000</span></span>
<span><span class="co">## 3   Missense point TET2          Ins/Del CBL    0.0156250 0.00000000</span></span>
<span><span class="co">## 4   Missense point EZH2         Ins/Del TET2    0.0625000 0.00000000</span></span>
<span><span class="co">## 5  Nonsense point ASXL1      Pattern XOR_CBL    0.0703125 0.01104854</span></span>
<span><span class="co">## 6     Pattern XOR_ASXL1   Missense point CBL    0.0468750 0.00000000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $capri_aic</span></span>
<span><span class="co">##                  SELECTS              SELECTED MEAN.POSTERR SD.POSTERR</span></span>
<span><span class="co">## 1          Ins/Del ASXL1   Missense point KRAS    0.0156250 0.00000000</span></span>
<span><span class="co">## 2  Missense point SETBP1  Nonsense point ASXL1    0.0781250 0.00000000</span></span>
<span><span class="co">## 3    Missense point TET2          Ins/Del EZH2    0.0156250 0.00000000</span></span>
<span><span class="co">## 4    Missense point TET2           Ins/Del CBL    0.0156250 0.00000000</span></span>
<span><span class="co">## 5    Missense point EZH2          Ins/Del TET2    0.0625000 0.00000000</span></span>
<span><span class="co">## 6    Nonsense point TET2   Missense point NRAS    0.0781250 0.00000000</span></span>
<span><span class="co">## 7    Nonsense point TET2 Pattern NRAS_xor_KRAS    0.1015625 0.01104854</span></span>
<span><span class="co">## 8   Nonsense point ASXL1       Pattern XOR_CBL    0.1015625 0.01104854</span></span>
<span><span class="co">## 9  Pattern TET2_xor_IDH2         Ins/Del ASXL1    0.1406250 0.00000000</span></span>
<span><span class="co">## 10     Pattern XOR_ASXL1    Missense point CBL    0.0468750 0.00000000</span></span></code></pre>
<p>Notice that these can be combined to create a nice table with all
these statistics – we make here the example of a table with all the BIC
statistics. This format can be readily exported to external spreadsheets
for further visualization.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tabular</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">obj</span>, <span class="va">M</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">tab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span></span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">...</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.selective.advantage.relations.html">as.selective.advantage.relations</a></span><span class="op">(</span><span class="va">obj</span>, models <span class="op">=</span> <span class="va">M</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="../reference/as.bootstrap.scores.html">as.bootstrap.scores</a></span><span class="op">(</span><span class="va">obj</span>, models <span class="op">=</span> <span class="va">M</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="../reference/as.kfold.prederr.html">as.kfold.prederr</a></span><span class="op">(</span><span class="va">obj</span>, models <span class="op">=</span> <span class="va">M</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="../reference/as.kfold.posterr.html">as.kfold.posterr</a></span><span class="op">(</span><span class="va">obj</span>,models <span class="op">=</span> <span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>    <span class="co"># merge reverses first with second column</span></span>
<span>    <span class="va">tab</span> <span class="op">=</span> <span class="va">tab</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">tab</span> <span class="op">=</span> <span class="va">tab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tab</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">M</span>, <span class="st">'.NONPAR.BOOT'</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span><span class="op">]</span>, na.last <span class="op">=</span> <span class="cn">TRUE</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">tabular</span><span class="op">(</span><span class="va">model.boot</span>, <span class="st">'capri_bic'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        capri_bic.SELECTS   capri_bic.SELECTED capri_bic.OBS.SELECTS</span></span>
<span><span class="co">## 13 Missense point SETBP1 Nonsense point ASXL1                    14</span></span>
<span><span class="co">## 1    Missense point TET2          Ins/Del CBL                     5</span></span>
<span><span class="co">## 2    Missense point TET2         Ins/Del EZH2                     5</span></span>
<span><span class="co">## 23  Nonsense point ASXL1      Pattern XOR_CBL                     5</span></span>
<span><span class="co">## 3    Missense point EZH2         Ins/Del TET2                     7</span></span>
<span><span class="co">## 4      Pattern XOR_ASXL1   Missense point CBL                    14</span></span>
<span><span class="co">##    capri_bic.OBS.SELECTED capri_bic.TEMPORAL.PRIORITY</span></span>
<span><span class="co">## 13                      5                1.265401e-08</span></span>
<span><span class="co">## 1                       1                7.055746e-07</span></span>
<span><span class="co">## 2                       1                3.107997e-08</span></span>
<span><span class="co">## 23                      4                1.253535e-02</span></span>
<span><span class="co">## 3                       4                8.288203e-04</span></span>
<span><span class="co">## 4                       3                1.181758e-08</span></span>
<span><span class="co">##    capri_bic.PROBABILITY.RAISING capri_bic.HYPERGEOMETRIC capri_bic.NONPAR.BOOT</span></span>
<span><span class="co">## 13                  6.653729e-09              0.002029387             100.00000</span></span>
<span><span class="co">## 1                   1.172650e-05              0.000000000              66.66667</span></span>
<span><span class="co">## 2                   2.968162e-05              0.078125000              33.33333</span></span>
<span><span class="co">## 23                  1.262353e-05              0.040873436              33.33333</span></span>
<span><span class="co">## 3                   1.739852e-06              0.055944826               0.00000</span></span>
<span><span class="co">## 4                   3.952172e-09              0.008736559               0.00000</span></span>
<span><span class="co">##    capri_bic.STAT.BOOT capri_bic.MEAN.PREDERR capri_bic.SD.PREDERR</span></span>
<span><span class="co">## 13                 100               0.078125                    0</span></span>
<span><span class="co">## 1                  100                     NA                   NA</span></span>
<span><span class="co">## 2                  100                     NA                   NA</span></span>
<span><span class="co">## 23                 100               0.093750                    0</span></span>
<span><span class="co">## 3                  100                     NA                   NA</span></span>
<span><span class="co">## 4                  100               0.046875                    0</span></span>
<span><span class="co">##    capri_bic.MEAN.POSTERR capri_bic.SD.POSTERR</span></span>
<span><span class="co">## 13              0.0781250           0.00000000</span></span>
<span><span class="co">## 1               0.0156250           0.00000000</span></span>
<span><span class="co">## 2               0.0156250           0.00000000</span></span>
<span><span class="co">## 23              0.0703125           0.01104854</span></span>
<span><span class="co">## 3               0.0625000           0.00000000</span></span>
<span><span class="co">## 4               0.0468750           0.00000000</span></span></code></pre>
<p>We finally show the plot of the model with the confidences by
cross-validation.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tronco.plot.html">tronco.plot</a></span><span class="op">(</span><span class="va">model.boot</span>, </span>
<span>    fontsize <span class="op">=</span> <span class="fl">12</span>, </span>
<span>    scale.nodes <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    confidence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'npb'</span>, <span class="st">'eloss'</span>, <span class="st">'prederr'</span>, <span class="st">'posterr'</span><span class="op">)</span>, </span>
<span>    height.logic <span class="op">=</span> <span class="fl">0.25</span>, </span>
<span>    legend.cex <span class="op">=</span> <span class="fl">.35</span>, </span>
<span>    pathways <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>priors<span class="op">=</span> <span class="va">gene.hypotheses</span><span class="op">)</span>, </span>
<span>    label.edge.size<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## *** Expanding hypotheses syntax as graph nodes:</span></span>
<span><span class="co">## *** Rendering graphics</span></span>
<span><span class="co">## Nodes with no incoming/outgoing edges will not be displayed.</span></span>
<span><span class="co">## Annotating nodes with pathway information. </span></span>
<span><span class="co">## Annotating pathways with RColorBrewer color palette Set1 .</span></span>
<span><span class="co">## Adding confidence information: npb, eloss, prederr, posterr </span></span>
<span><span class="co">## RGraphviz object prepared.</span></span>
<span><span class="co">## Plotting graph and adding legends.</span></span></code></pre>
<div class="figure">
<img src="6_post_reconstruction_files/figure-html/unnamed-chunk-18-1.png" alt="aCML model reconstructed by CAPRI with  AIC/BIC as regolarizators and annotated with  non-parametric, as well as with entropy loss, prediction and posterior classification errors computed via cross-validation. Edge thickness is proportional to the non-parametric  scores." width="384"><p class="caption">
aCML model reconstructed by CAPRI with AIC/BIC as regolarizators and
annotated with non-parametric, as well as with entropy loss, prediction
and posterior classification errors computed via cross-validation. Edge
thickness is proportional to the non-parametric scores.
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giulio Caravagna, Luca De Sano, Alex Graudenzi, Daniele Ramazzotti.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
